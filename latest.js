!function(e){if("function"==typeof bootstrap)bootstrap("simplewebrtc",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeSimpleWebRTC=e}else"undefined"!=typeof window?window.SimpleWebRTC=e():global.SimpleWebRTC=e()}(function(){return function(e,t,n){function r(n,i){if(!t[n]){if(!e[n]){var a="function"==typeof require&&require;if(!i&&a)return a(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=t[n]={exports:{}};e[n][0].call(s.exports,function(t){var o=e[n][1][t];return r(o?o:t)},s,s.exports)}return t[n].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t){function n(e){var t,n,u=this,d=e||{},l=this.config={url:"https://signaling.simplewebrtc.com:443/",wsUrl:"ws://135.55.22.67:9727",connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!0,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},localVideo:{autoplay:!0,mirror:!0,muted:!0}};this.logger=function(){return e.debug?e.logger||console:e.logger||s}();for(t in d)this.config[t]=d[t];this.capabilities=i,o.call(this),this.createConnection=function(e){null===u.config.connection?(console.log(l.wsUrl+"ws/"+e),n=new WebSocket(l.url+"ws/"+e),n.onopen=function(){console.log("Socket open! Sending message to authenticate!")},n.onerror=function(){console.log("Socket error occured")},n.onclose=function(){console.log("Socket is closed!")},n.onConnect=function(e){e.stunservers&&(u.webrtc.config.peerConnectionConfig.iceServers=e.stunservers,u.emit("stunservers",e.stunservers)),e.turnservers&&(u.webrtc.config.peerConnectionConfig.iceServers=u.webrtc.config.peerConnectionConfig.iceServers.concat(e.turnservers),u.emit("turnservers",e.turnservers)),n.sessionid=e.sessionid,u.emit("connectionReady",e.sessionid),u.sessionReady=!0,u.testReadiness()},n.onMessage=function(e){var t,n=u.webrtc.getPeers(e.from,e.roomType);"offer"===e.type?(n.length&&n.forEach(function(n){n.sid==e.sid&&(t=n)}),t||(t=u.webrtc.createPeer({id:e.from,sid:e.sid,type:e.roomType,enableDataChannels:u.config.enableDataChannels&&"screen"!==e.roomType,sharemyscreen:"screen"===e.roomType&&!e.broadcaster,broadcaster:"screen"!==e.roomType||e.broadcaster?null:u.connection.sessionid}),u.emit("createdPeer",t)),t.handleMessage(e)):n.length&&n.forEach(function(t){e.sid?t.sid===e.sid&&t.handleMessage(e):t.handleMessage(e)})},n.onRemove=function(e){e.id!==u.connection.sessionid()&&u.webrtc.removePeers(e.id,e.type)},n.onJoin=function(e){var t=e.roomDescription,n=e.err;if(n)u.emit("error",n);else if(t){var r,o,i,a;for(r in t){o=t[r];for(i in o)o[i]&&(a=u.webrtc.createPeer({id:r,type:i,enableDataChannels:u.config.enableDataChannels&&"screen"!==i,receiveMedia:{mandatory:{OfferToReceiveAudio:"screen"!==i&&u.config.receiveMedia.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:u.config.receiveMedia.mandatory.OfferToReceiveVideo}}}),u.emit("createdPeer",a),a.start())}}u.joinCb&&u.joinCb(n,t),u.emit("joinedRoom",name)},n.disconnect=function(){n.emit("disconnect"),n.close(),n=null},n.emit=function(e,t){if(n)if(n.readyState===c.OPEN){var r={event:e};t&&(r.data=t);try{n.send(JSON.stringify(r))}catch(o){console.log("Connection send exeption"),console.log(o)}}else alert("Not connected to Snap Engage server, should reconnect here");else alert("Not connected to Snap Engage server, should reconnect here")},n.onmessage=function(e){switch(e.event){case"message":n.onMessage(e.data);break;case"connect":n.onConnect(e.data);break;case"remove":n.onRemove(e.data);break;case"stunservers":n.onStun(e.data);break;case"turnservers":n.onTurn(e.data);break;case"_join":n.onJoin(e.data);break;default:console.log("Unknown socket event")}}):n=this.connection=this.config.connection},e.logger=this.logger,e.debug=!1,this.webrtc=new r(e),["mute","unmute","pauseVideo","resumeVideo","pause","resume","sendToAll","sendDirectlyToAll","getPeers"].forEach(function(e){u[e]=u.webrtc[e].bind(u.webrtc)}),this.webrtc.on("*",function(){u.emit.apply(u,arguments)}),l.debug&&this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:")),this.webrtc.on("localStream",function(){u.testReadiness()}),this.webrtc.on("message",function(e){u.connection.emit("message",e)}),this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this)),this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this)),this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1))),this.webrtc.on("iceFailed",function(e){console.log("Local ICE failure for peer:"),console.log(e)}),this.webrtc.on("connectivityError",function(e){console.log("Remote ICE failure for peer:"),console.log(e)}),this.webrtc.on("audioOn",function(){u.webrtc.sendToAll("unmute",{name:"audio"})}),this.webrtc.on("audioOff",function(){u.webrtc.sendToAll("mute",{name:"audio"})}),this.webrtc.on("videoOn",function(){u.webrtc.sendToAll("unmute",{name:"video"})}),this.webrtc.on("videoOff",function(){u.webrtc.sendToAll("mute",{name:"video"})}),this.webrtc.on("localScreen",function(e){var t=document.createElement("video"),n=u.getRemoteVideoContainer();t.oncontextmenu=function(){return!1},t.id="localScreen",a(e,t),n&&n.appendChild(t),u.emit("localScreenAdded",t),u.connection.emit("shareScreen"),u.webrtc.peers.forEach(function(e){var t;"video"===e.type&&(t=u.webrtc.createPeer({id:e.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},broadcaster:u.connection.sessionid}),u.emit("createdPeer",t),t.start())})}),this.webrtc.on("localScreenStopped",function(){u.stopScreenShare()}),this.webrtc.on("channelMessage",function(e,t,n){"volume"==n.type&&u.emit("remoteVolumeChange",e,n.volume)}),this.config.autoRequestMedia&&this.startLocalVideo()}var r=e("./webrtc"),o=e("wildemitter"),i=e("webrtcsupport"),a=e("attachmediastream"),s=e("mockconsole"),c={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};n.prototype=Object.create(o.prototype,{constructor:{value:n}}),n.prototype.leaveRoom=function(){this.roomName&&(this.connection.emit("leave"),this.webrtc.peers.forEach(function(e){e.end()}),this.getLocalScreen()&&this.stopScreenShare(),this.emit("leftRoom",this.roomName),this.roomName=void 0)},n.prototype.disconnect=function(){this.connection.disconnect(),delete this.connection},n.prototype.handlePeerStreamAdded=function(e){var t=this,n=this.getRemoteVideoContainer(),r=a(e.stream);e.videoEl=r,r.id=this.getDomId(e),n&&n.appendChild(r),this.emit("videoAdded",r,e),window.setTimeout(function(){t.webrtc.isAudioEnabled()||e.send("mute",{name:"audio"}),t.webrtc.isVideoEnabled()||e.send("mute",{name:"video"})},250)},n.prototype.handlePeerStreamRemoved=function(e){var t=this.getRemoteVideoContainer(),n=e.videoEl;this.config.autoRemoveVideos&&t&&n&&t.removeChild(n),n&&this.emit("videoRemoved",n,e)},n.prototype.getDomId=function(e){return[e.id,e.type,e.broadcaster?"broadcasting":"incoming"].join("_")},n.prototype.setVolumeForAll=function(e){this.webrtc.peers.forEach(function(t){t.videoEl&&(t.videoEl.volume=e)})},n.prototype.joinRoom=function(e,t){this.roomName=e,this.joinCb=t?t:null,this.createConnection(e)},n.prototype.getEl=function(e){return"string"==typeof e?document.getElementById(e):e},n.prototype.startLocalVideo=function(){var e=this;this.webrtc.startLocalMedia(this.config.media,function(t,n){t?e.emit("localMediaError",t):a(n,e.getLocalVideoContainer(),e.config.localVideo)})},n.prototype.stopLocalVideo=function(){this.webrtc.stopLocalMedia()},n.prototype.getLocalVideoContainer=function(){var e=this.getEl(this.config.localVideoEl);if(e&&"VIDEO"===e.tagName)return e.oncontextmenu=function(){return!1},e;if(e){var t=document.createElement("video");return t.oncontextmenu=function(){return!1},e.appendChild(t),t}},n.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)},n.prototype.shareScreen=function(e){this.webrtc.startScreenShare(e)},n.prototype.getLocalScreen=function(){return this.webrtc.localScreen},n.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var e=document.getElementById("localScreen"),t=this.getRemoteVideoContainer(),n=this.getLocalScreen();this.config.autoRemoveVideos&&t&&e&&t.removeChild(e),e&&this.emit("videoRemoved",e),n&&n.stop(),this.webrtc.peers.forEach(function(e){e.broadcaster&&e.end()})},n.prototype.testReadiness=function(){var e=this;this.webrtc.localStream&&this.sessionReady&&e.emit("readyToCall",e.connection.sessionid)},n.prototype.sendFile=function(){return i.dataChannel?void 0:this.emit("error",new Error("DataChannelNotSupported"))},t.exports=n},{"./webrtc":2,attachmediastream:6,mockconsole:5,webrtcsupport:4,wildemitter:3}],3:[function(e,t){function n(){this.isWildEmitter=!0,this.callbacks={}}t.exports=n,n.prototype.on=function(e){var t=3===arguments.length,n=t?arguments[1]:void 0,r=t?arguments[2]:arguments[1];return r._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},n.prototype.once=function(e){function t(){n.off(e,t),i.apply(this,arguments)}var n=this,r=3===arguments.length,o=r?arguments[1]:void 0,i=r?arguments[2]:arguments[1];return this.on(e,o,t),this},n.prototype.releaseGroup=function(e){var t,n,r,o;for(t in this.callbacks)for(o=this.callbacks[t],n=0,r=o.length;r>n;n++)o[n]._groupName===e&&(o.splice(n,1),n--,r--);return this},n.prototype.off=function(e,t){var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e],this):this},n.prototype.emit=function(e){var t,n,r,o=[].slice.call(arguments,1),i=this.callbacks[e],a=this.getWildcardCallbacks(e);if(i)for(r=i.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,o);if(a)for(n=a.length,r=a.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,[e].concat(o));return this},n.prototype.getWildcardCallbacks=function(e){var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},{}],4:[function(e,t){var n,r;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(n="moz",r=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(n="webkit",r=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var o=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,i=window.mozRTCIceCandidate||window.RTCIceCandidate,a=window.mozRTCSessionDescription||window.RTCSessionDescription,s=window.webkitMediaStream||window.MediaStream,c="https:"===window.location.protocol&&("webkit"===n&&r>=26||"moz"===n&&r>=33),u=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),l=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:n,browserVersion:r,support:!!o&&l&&!!p,supportRTCPeerConnection:!!o,supportVp8:l,supportGetUserMedia:!!p,supportDataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),supportWebAudio:!(!u||!u.prototype.createMediaStreamSource),supportMediaStream:!(!s||!s.prototype.removeTrack),supportScreenSharing:!!c,dataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),webAudio:!(!u||!u.prototype.createMediaStreamSource),mediaStream:!(!s||!s.prototype.removeTrack),screenSharing:!!c,AudioContext:u,PeerConnection:o,SessionDescription:a,IceCandidate:i,MediaStream:s,getUserMedia:p}},{}],5:[function(e,t){for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),r=n.length,o=function(){},i={};r--;)i[n[r]]=o;t.exports=i},{}],6:[function(e,t){t.exports=function(e,t,n){var r,o=window.URL,i={autoplay:!0,mirror:!1,muted:!1},a=t||document.createElement("video");if(n)for(r in n)i[r]=n[r];if(i.autoplay&&(a.autoplay="autoplay"),i.muted&&(a.muted=!0),i.mirror&&["","moz","webkit","o","ms"].forEach(function(e){var t=e?e+"Transform":"transform";a.style[t]="scaleX(-1)"}),o&&o.createObjectURL)a.src=o.createObjectURL(e);else if(a.srcObject)a.srcObject=e;else{if(!a.mozSrcObject)return!1;a.mozSrcObject=e}return a}},{}],2:[function(e,t){function n(e){var t=this,n=e||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{url:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[{DtlsSrtpKeyAgreement:!0}]},receiveMedia:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},enableDataChannels:!0};var r;this.screenSharingSupport=o.screenSharing,this.logger=function(){return e.debug?e.logger||console:e.logger||i}();for(r in n)this.config[r]=n[r];o.support||this.logger.error("Your browser doesn't seem to support WebRTC"),this.peers=[],a.call(this,this.config),this.on("speaking",function(){t.hardMuted||t.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"speaking"}))}})}),this.on("stoppedSpeaking",function(){t.hardMuted||t.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"stoppedSpeaking"}))}})}),this.on("volumeChange",function(e){t.hardMuted||t.peers.forEach(function(t){if(t.enableDataChannels){var n=t.getDataChannel("hark");if("open"!=n.readyState)return;n.send(JSON.stringify({type:"volume",volume:e}))}})}),this.config.debug&&this.on("*",function(e,n,r){var o;o=t.config.logger===i?console:t.logger,o.log("event:",e,n,r)})}var r=e("util"),o=e("webrtcsupport"),i=e("mockconsole"),a=e("localmedia"),s=e("./peer");r.inherits(n,a),n.prototype.createPeer=function(e){var t;return e.parent=this,t=new s(e),this.peers.push(t),t},n.prototype.removePeers=function(e,t){this.getPeers(e,t).forEach(function(e){e.end()})},n.prototype.getPeers=function(e,t){return this.peers.filter(function(n){return!(e&&n.id!==e||t&&n.type!==t)})},n.prototype.sendToAll=function(e,t){this.peers.forEach(function(n){n.send(e,t)})},n.prototype.sendDirectlyToAll=function(e,t,n){this.peers.forEach(function(r){r.enableDataChannels&&r.sendDirectly(e,t,n)})},t.exports=n},{"./peer":8,localmedia:9,mockconsole:5,util:7,webrtcsupport:4}],7:[function(e,t,n){function r(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===Object.prototype.toString.call(e)}function o(e){"object"==typeof e&&"[object RegExp]"===Object.prototype.toString.call(e)}function i(e){return"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}e("events"),n.isArray=r,n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(e,t,c,u){function d(e,c){if(e&&"function"==typeof e.inspect&&e!==n&&(!e.constructor||e.constructor.prototype!==e))return e.inspect(c);switch(typeof e){case"undefined":return p("undefined","undefined");case"string":var u="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return p(u,"string");case"number":return p(""+e,"number");case"boolean":return p(""+e,"boolean")}if(null===e)return p("null","null");var f=a(e),h=t?s(e):f;if("function"==typeof e&&0===h.length){if(o(e))return p(""+e,"regexp");var g=e.name?": "+e.name:"";return p("[Function"+g+"]","special")}if(i(e)&&0===h.length)return p(e.toUTCString(),"date");var m,v,y;if(r(e)?(v="Array",y=["[","]"]):(v="Object",y=["{","}"]),"function"==typeof e){var b=e.name?": "+e.name:"";m=o(e)?" "+e:" [Function"+b+"]"}else m="";if(i(e)&&(m=" "+e.toUTCString()),0===h.length)return y[0]+m+y[1];if(0>c)return o(e)?p(""+e,"regexp"):p("[Object]","special");l.push(e);var S=h.map(function(t){var n,o;if(e.__lookupGetter__&&(e.__lookupGetter__(t)?o=e.__lookupSetter__(t)?p("[Getter/Setter]","special"):p("[Getter]","special"):e.__lookupSetter__(t)&&(o=p("[Setter]","special"))),f.indexOf(t)<0&&(n="["+t+"]"),o||(l.indexOf(e[t])<0?(o=null===c?d(e[t]):d(e[t],c-1),o.indexOf("\n")>-1&&(o=r(e)?o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n"))):o=p("[Circular]","special")),"undefined"==typeof n){if("Array"===v&&t.match(/^\d+$/))return o;n=JSON.stringify(""+t),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=p(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=p(n,"string"))}return n+": "+o});l.pop();var w=0,C=S.reduce(function(e,t){return w++,t.indexOf("\n")>=0&&w++,e+t.length+1},0);return S=C>50?y[0]+(""===m?"":m+"\n ")+" "+S.join(",\n  ")+" "+y[1]:y[0]+m+" "+S.join(", ")+" "+y[1]}var l=[],p=function(e,t){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[t];return r?"["+n[r][0]+"m"+e+"["+n[r][1]+"m":e};return u||(p=function(e){return e}),d(e,"undefined"==typeof c?2:c)},n.log=function(){},n.pump=null;var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},s=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&t.push(n);return t},c=Object.create||function(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var r=function(){};r.prototype=e,n=new r,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n};n.inherits=function(e,t){e.super_=t,e.prototype=c(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})};var u=/%[sdj%]/g;n.format=function(e){if("string"!=typeof e){for(var t=[],r=0;r<arguments.length;r++)t.push(n.inspect(arguments[r]));return t.join(" ")}for(var r=1,o=arguments,i=o.length,a=String(e).replace(u,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(o[r++]);case"%d":return Number(o[r++]);case"%j":return JSON.stringify(o[r++]);default:return e}}),s=o[r];i>r;s=o[++r])a+=null===s||"object"!=typeof s?" "+s:" "+n.inspect(s);return a}},{events:10}],11:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],10:[function(e,t,n){function r(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}var o=e("__browserify_process");o.EventEmitter||(o.EventEmitter=function(){});var i=n.EventEmitter=o.EventEmitter,a="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=10;i.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},i.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||a(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(a(t)){for(var n=Array.prototype.slice.call(arguments,1),r=t.slice(),o=0,i=r.length;i>o;o++)r[o].apply(this,n);return!0}return!1},i.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,t),this._events[e])if(a(this._events[e])){if(!this._events[e].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:s,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(t)}else this._events[e]=[this._events[e],t];else this._events[e]=t;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){var n=this;return n.on(e,function r(){n.removeListener(e,r),t.apply(this,arguments)}),this},i.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var n=this._events[e];if(a(n)){var o=r(n,t);if(0>o)return this;n.splice(o,1),0==n.length&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},i.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},i.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),a(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},i.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?"function"==typeof e._events[t]?1:e._events[t].length:0}},{__browserify_process:11}],8:[function(e,t){function n(e){var t=this;this.id=e.id,this.parent=e.parent,this.type=e.type||"video",this.oneway=e.oneway||!1,this.sharemyscreen=e.sharemyscreen||!1,this.browserPrefix=e.prefix,this.stream=e.stream,this.enableDataChannels=void 0===e.enableDataChannels?this.parent.config.enableDataChannels:e.enableDataChannels,this.receiveMedia=e.receiveMedia||this.parent.config.receiveMedia,this.channels={},this.sid=e.sid||Date.now().toString(),this.pc=new i(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("offer",function(e){t.parent.config.nick&&(e.nick=t.parent.config.nick),t.send("offer",e)}),this.pc.on("answer",function(e){t.parent.config.nick&&(e.nick=t.parent.config.nick),t.send("answer",e)}),this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this)),this.pc.on("addChannel",this.handleDataChannelAdded.bind(this)),this.pc.on("removeStream",this.handleStreamRemoved.bind(this)),this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded")),this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange")),this.pc.on("iceConnectionStateChange",function(){switch(t.pc.iceConnectionState){case"failed":"offer"===t.pc.pc.peerconnection.localDescription.type&&(t.parent.emit("iceFailed",t),t.send("connectivityError"))}}),this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange")),this.logger=this.parent.logger,"screen"===e.type?this.parent.localScreen&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreen),this.broadcaster=e.broadcaster):this.parent.localStreams.forEach(function(e){t.pc.addStream(e)}),a.call(this),this.on("channelOpen",function(e){e.protocol===c&&(e.onmessage=function(n){var r=JSON.parse(n.data),o=new s.Receiver;o.receive(r,e),t.emit("fileTransfer",r,o),o.on("receivedFile",function(){o.channel.close()})})}),this.on("*",function(){t.parent.emit.apply(t.parent,arguments)})}var r=e("util"),o=e("webrtcsupport"),i=e("rtcpeerconnection"),a=e("wildemitter"),s=e("filetransfer"),c="https://simplewebrtc.com/protocol/filetransfer#inband-v1";r.inherits(n,a),n.prototype.handleMessage=function(e){var t=this;this.logger.log("getting",e.type,e),e.prefix&&(this.browserPrefix=e.prefix),"offer"===e.type?(this.nick||(this.nick=e.payload.nick),delete e.payload.nick,e.payload.sdp=e.payload.sdp.replace("a=fmtp:0 profile-level-id=0x42e00c;packetization-mode=1\r\n",""),this.pc.handleOffer(e.payload,function(e){e||t.pc.answer(t.receiveMedia,function(){})})):"answer"===e.type?(this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleAnswer(e.payload)):"candidate"===e.type?this.pc.processIce(e.payload):"connectivityError"===e.type?this.parent.emit("connectivityError",t):"mute"===e.type?this.parent.emit("mute",{id:e.from,name:e.payload.name}):"unmute"===e.type&&this.parent.emit("unmute",{id:e.from,name:e.payload.name})},n.prototype.send=function(e,t){var n={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:e,payload:t,prefix:o.prefix};this.logger.log("sending",e,n),this.parent.emit("message",n)},n.prototype.sendDirectly=function(e,t,n){var r={type:t,payload:n};this.logger.log("sending via datachannel",e,t,r);var o=this.getDataChannel(e);return"open"!=o.readyState?!1:(o.send(JSON.stringify(r)),!0)},n.prototype._observeDataChannel=function(e){var t=this;e.onclose=this.emit.bind(this,"channelClose",e),e.onerror=this.emit.bind(this,"channelError",e),e.onmessage=function(n){t.emit("channelMessage",t,e.label,JSON.parse(n.data),e,n)},e.onopen=this.emit.bind(this,"channelOpen",e)},n.prototype.getDataChannel=function(e,t){if(!o.supportDataChannel)return this.emit("error",new Error("createDataChannel not supported"));var n=this.channels[e];return t||(t={}),n?n:(n=this.channels[e]=this.pc.createDataChannel(e,t),this._observeDataChannel(n),n)},n.prototype.onIceCandidate=function(e){if(!this.closed)if(e){var t=this.parent.config.peerConnectionConfig;"moz"===o.prefix&&t&&t.iceTransports&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.indexOf(t.iceTransports)<0?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",t.iceTransports):this.send("candidate",e)}else this.logger.log("End of candidates.")},n.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc"),this.pc.offer(this.receiveMedia,function(){})},n.prototype.icerestart=function(){var e=this.receiveMedia;e.mandatory.IceRestart=!0,this.pc.offer(e,function(){})},n.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())},n.prototype.handleRemoteStreamAdded=function(e){var t=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=e.stream,this.stream.onended=function(){t.end()},this.parent.emit("peerStreamAdded",this))},n.prototype.handleStreamRemoved=function(){this.parent.peers.splice(this.parent.peers.indexOf(this),1),this.closed=!0,this.parent.emit("peerStreamRemoved",this)},n.prototype.handleDataChannelAdded=function(e){this.channels[e.label]=e,this._observeDataChannel(e)},n.prototype.sendFile=function(e){var t=new s.Sender,n=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:c});return n.onopen=function(){n.send(JSON.stringify({size:e.size,name:e.name})),t.send(e,n)},n.onclose=function(){console.log("sender received transfer"),t.emit("complete")},t},t.exports=n},{filetransfer:12,rtcpeerconnection:13,util:7,webrtcsupport:4,wildemitter:3}],14:[function(e,t){var n=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia;t.exports=function(e,t){var r,o=2===arguments.length,i={video:!0,audio:!0},a="PermissionDeniedError",s="PERMISSION_DENIED",c="ConstraintNotSatisfiedError";return o||(t=e,e=i),n?e.audio||e.video?(localStorage&&"true"===localStorage.useFirefoxFakeDevice&&(e.fake=!0),n.call(window.navigator,e,function(e){t(null,e)},function(e){var n;"string"==typeof e?(n=new Error("MediaStreamError"),n.name=e===a||e===s?a:c):(n=e,n.name||(e.name=n[a]?a:c)),t(n)}),void 0):(r=new Error("MediaStreamError"),r.name="NoMediaRequestedError",window.setTimeout(function(){t(r)},0)):(r=new Error("MediaStreamError"),r.name="NotSupportedError",window.setTimeout(function(){t(r)},0))}},{}],9:[function(e,t){function n(e){c.call(this);var t,n=this.config={autoAdjustMic:!1,detectSpeakingEvents:!0,media:{audio:!0,video:!0},logger:d};for(t in e)this.config[t]=e[t];this.logger=n.logger,this._log=this.logger.log.bind(this.logger,"LocalMedia:"),this._logerror=this.logger.error.bind(this.logger,"LocalMedia:"),this.screenSharingSupport=i.screenSharing,this.localStreams=[],this.localScreens=[],i.support||this._logerror("Your browser does not support local media capture.")}var r=e("util"),o=e("hark"),i=e("webrtcsupport"),a=e("getusermedia"),s=e("getscreenmedia"),c=e("wildemitter"),u=e("mediastream-gain"),d=e("mockconsole");r.inherits(n,c),n.prototype.start=function(e,t){var n=this,r=e||this.config.media;a(r,function(e,o){return e||(r.audio&&n.config.detectSpeakingEvents&&n.setupAudioMonitor(o,n.config.harkOptions),n.localStreams.push(o),n.config.autoAdjustMic&&(n.gainController=new u(o),n.setMicIfEnabled(.5)),o.onended=function(){},n.emit("localStream",o)),t?t(e,o):void 0})},n.prototype.stop=function(e){var t=this;if(e){e.stop(),t.emit("localStreamStopped",e);var n=t.localStreams.indexOf(e);n>-1&&(t.localStreams=t.localStreams.splice(n,1))}else this.audioMonitor&&(this.audioMonitor.stop(),delete this.audioMonitor),this.localStreams.forEach(function(e){e.stop(),t.emit("localStreamStopped",e)}),this.localStreams=[]},n.prototype.startScreenShare=function(e){var t=this;s(function(n,r){return n||(t.localScreens.push(r),r.onended=function(){var e=t.localScreens.indexOf(r);e>-1&&t.localScreens.splice(e,1),t.emit("localScreenStopped",r)},t.emit("localScreen",r)),e?e(n,r):void 0})},n.prototype.stopScreenShare=function(e){e?e.stop():(this.localScreens.forEach(function(e){e.stop()}),this.localScreens=[])},n.prototype.mute=function(){this._audioEnabled(!1),this.hardMuted=!0,this.emit("audioOff")},n.prototype.unmute=function(){this._audioEnabled(!0),this.hardMuted=!1,this.emit("audioOn")},n.prototype.setupAudioMonitor=function(e,t){this._log("Setup audio");var n,r=this.audioMonitor=o(e,t),i=this;r.on("speaking",function(){i.emit("speaking"),i.hardMuted||i.setMicIfEnabled(1)}),r.on("stopped_speaking",function(){n&&clearTimeout(n),n=setTimeout(function(){i.emit("stoppedSpeaking"),i.hardMuted||i.setMicIfEnabled(.5)},1e3)}),r.on("volume_change",function(e,t){i.emit("volumeChange",e,t)})},n.prototype.setMicIfEnabled=function(e){this.config.autoAdjustMic&&this.gainController.setGain(e)},n.prototype.pauseVideo=function(){this._videoEnabled(!1),this.emit("videoOff")},n.prototype.resumeVideo=function(){this._videoEnabled(!0),this.emit("videoOn")},n.prototype.pause=function(){this.mute(),this.pauseVideo()},n.prototype.resume=function(){this.unmute(),this.resumeVideo()},n.prototype._audioEnabled=function(e){this.setMicIfEnabled(e?1:0),this.localStreams.forEach(function(t){t.getAudioTracks().forEach(function(t){t.enabled=!!e})})},n.prototype._videoEnabled=function(e){this.localStreams.forEach(function(t){t.getVideoTracks().forEach(function(t){t.enabled=!!e})})},n.prototype.isAudioEnabled=function(){var e=!0;return this.localStreams.forEach(function(t){t.getAudioTracks().forEach(function(t){e=e&&t.enabled})}),e},n.prototype.isVideoEnabled=function(){var e=!0;return this.localStreams.forEach(function(t){t.getVideoTracks().forEach(function(t){e=e&&t.enabled})}),e},n.prototype.startLocalMedia=n.prototype.start,n.prototype.stopLocalMedia=n.prototype.stop,Object.defineProperty(n.prototype,"localStream",{get:function(){return this.localStreams.length>0?this.localStreams[0]:null
}}),Object.defineProperty(n.prototype,"localScreen",{get:function(){return this.localScreens.length>0?this.localScreens[0]:null}}),t.exports=n},{getscreenmedia:16,getusermedia:14,hark:15,"mediastream-gain":17,mockconsole:5,util:7,webrtcsupport:4,wildemitter:3}],12:[function(e,t){function n(e){o.call(this);var t=e||{};this.config={chunksize:16384,pacing:0};var n;for(n in t)this.config[n]=t[n];this.file=null,this.channel=null}function r(){o.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}var o=e("wildemitter"),i=e("util");i.inherits(n,o),n.prototype.send=function(e,t){var n=this;this.file=e,this.channel=t;var r=function(t){var o=new window.FileReader;o.onload=function(){return function(o){n.channel.send(o.target.result),n.emit("progress",t,e.size,o.target.result),e.size>t+o.target.result.byteLength?window.setTimeout(r,n.config.pacing,t+n.config.chunksize):(n.emit("progress",e.size,e.size,null),n.emit("sentFile"))}}(e);var i=e.slice(t,t+n.config.chunksize);o.readAsArrayBuffer(i)};window.setTimeout(r,0,0)},i.inherits(r,o),r.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),this.channel=t,t.binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support=window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=n,t.exports.Receiver=r},{util:7,wildemitter:3}],15:[function(e,t){function n(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,o=t.length;o>r;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}var r=e("wildemitter"),o=window.AudioContext||window.webkitAudioContext,i=null;t.exports=function(e,t){var a=new r;if(!o)return a;var t=t||{},s=t.smoothing||.1,c=t.interval||50,u=t.threshold,d=t.play,l=t.history||10,p=!0;i||(i=new o);var f,h,g;g=i.createAnalyser(),g.fftSize=512,g.smoothingTimeConstant=s,h=new Float32Array(g.fftSize),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(f=i.createMediaElementSource(e),"undefined"==typeof d&&(d=!0),u=u||-50):(f=i.createMediaStreamSource(e),u=u||-50),f.connect(g),d&&g.connect(i.destination),a.speaking=!1,a.setThreshold=function(e){u=e},a.setInterval=function(e){c=e},a.stop=function(){p=!1,a.emit("volume_change",-100,u),a.speaking&&(a.speaking=!1,a.emit("stopped_speaking"))},a.speakingHistory=[];for(var m=0;l>m;m++)a.speakingHistory.push(0);var v=function(){setTimeout(function(){if(p){var e=n(g,h);a.emit("volume_change",e,u);var t=0;if(e>u&&!a.speaking){for(var r=a.speakingHistory.length-3;r<a.speakingHistory.length;r++)t+=a.speakingHistory[r];t>=2&&(a.speaking=!0,a.emit("speaking"))}else if(u>e&&a.speaking){for(var r=0;r<a.speakingHistory.length;r++)t+=a.speakingHistory[r];0==t&&(a.speaking=!1,a.emit("stopped_speaking"))}a.speakingHistory.shift(),a.speakingHistory.push(0+(e>u)),v()}},c)};return v(),a}},{wildemitter:18}],13:[function(e,t){function n(e,t){var n,r=this;c.call(this),e=e||{},e.iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&"webkit"===a.prefix&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&"webkit"===a.prefix&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&"webkit"===a.prefix&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),"moz"===a.prefix&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new u(e,t),this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc),this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=this.pc.removeStream.bind(this.pc),this.pc.on("*",function(){r.emit.apply(r,arguments)}),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,ice:{},sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}var r=e("util"),o=e("lodash.foreach"),i=e("lodash.pluck"),a=e("webrtcsupport"),s=e("sdp-jingle-json"),c=e("wildemitter"),u=e("traceablepeerconnection");r.inherits(n,c),Object.defineProperty(n.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(n.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),n.prototype._role=function(){return this.isInitiator?"initiator":"responder"},n.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},n.prototype._checkLocalCandidate=function(e){var t=s.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},n.prototype._checkRemoteCandidate=function(e){var t=s.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},n.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=i(this.remoteDescription.contents,"name"),o=e.contents||e.jingle.contents;o.forEach(function(e){var t=e.transport||{},o=t.candidates||[],i=r.indexOf(e.name),c=e.name;o.forEach(function(e){var t=s.toCandidateSDP(e)+"\r\n";n.pc.addIceCandidate(new a.IceCandidate({candidate:t,sdpMLineIndex:i,sdpMid:c}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)})})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new a.IceCandidate(e.candidate),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate)}t()},n.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};return t=r?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):(this.pc.createOffer(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var i;n.config.useJingle&&(i=s.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),i.sid=n.config.sid,n.localDescription=i,o(i.contents,function(e){var t=e.transport||{};t.ufrag&&(n.config.ice[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=i),r.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},i),void 0)},n.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.description.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.description.sources||[];(0===t.length||"3735928559"!==t[0].ssrc)&&(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.description.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1],o=r.description&&r.description.bandwidth;o||(e.jingle.contents[1].description.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=s.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.sdp=s.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new a.SessionDescription(e),function(){t()},t)},n.prototype.answerAudioOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(t,e)},n.prototype.answerBroadcastOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(t,e)},n.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,o=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(o,r)},n.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=s.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new a.SessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new a.IceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},n.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},n.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):(n.pc.createAnswer(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=s.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var o=e.jingle.contents[1].description.sourceGroups||[],i=!1;if(o.forEach(function(e){"SIM"==e.semantics&&(i=!0)}),!i&&e.jingle.contents[1].description.sources.length){var a=JSON.parse(JSON.stringify(e.jingle.contents[1].description.sources[0]));a.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].description.sources.push(a),r.push(e.jingle.contents[1].description.sources[0].ssrc),r.push(a.ssrc),o.push({semantics:"SIM",sources:r});var c=JSON.parse(JSON.stringify(a));c.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].description.sources.push(c),o.push({semantics:"FID",sources:[a.ssrc,c.ssrc]}),e.jingle.contents[1].description.sourceGroups=o,e.sdp=s.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var u={type:"answer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("answer",u),t(null,u)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var r=s.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,u.jingle=r}n.enableChromeNativeSimulcast&&(u.jingle||(u.jingle=s.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),u.jingle.contents[1].description.sourceGroups||[],u.jingle.contents[1].description.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),u.sdp=s.toSessionSDP(u.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),u.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("answer",u),t(null,u))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e),void 0)},n.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var i,a,c=s.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===c.type&&(i=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component}),a=i.indexOf(c.foundation+":"+c.component),a>-1&&c.priority>>24>=i[a].priority>>24))return;if("max-bundle"===this.config.bundlePolicy&&(i=this._candidateBuffer.filter(function(e){return c.type===e.type}).map(function(e){return e.address+":"+e.port}),a=i.indexOf(c.address+":"+c.port),a>-1))return;if("require"===this.config.rtcpMuxPolicy&&"2"===c.component)return;if(this._candidateBuffer.push(c),t.config.useJingle){if(n.sdpMid||(n.sdpMid=t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?t.remoteDescription.contents[n.sdpMLineIndex].name:t.localDescription.contents[n.sdpMLineIndex].name),!t.config.ice[n.sdpMid]){var u=s.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"});o(u.contents,function(e){var n=e.transport||{};n.ufrag&&(t.config.ice[e.name]={ufrag:n.ufrag,pwd:n.pwd})})}if(r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transType:"iceUdp",ufrag:t.config.ice[n.sdpMid].ufrag,pwd:t.config.ice[n.sdpMid].pwd,candidates:[c]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),t.batchedIceCandidates.push(r.jingle),void 0}this.emit("ice",r)}else this.emit("endOfCandidates")},n.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},n.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},n.prototype.getStats=function(e){"moz"===a.prefix?this.pc.getStats(function(t){var n=[];for(var r in t)"object"==typeof t[r]&&n.push(t[r]);e(null,n)},e):this.pc.getStats(function(t){var n=[];t.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,n.push(t)}),e(null,n)})},t.exports=n},{"lodash.foreach":21,"lodash.pluck":22,"sdp-jingle-json":19,traceablepeerconnection:20,util:7,webrtcsupport:4,wildemitter:3}],18:[function(e,t){function n(){this.callbacks={}}t.exports=n,n.prototype.on=function(e){var t=3===arguments.length,n=t?arguments[1]:void 0,r=t?arguments[2]:arguments[1];return r._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},n.prototype.once=function(e){function t(){n.off(e,t),i.apply(this,arguments)}var n=this,r=3===arguments.length,o=r?arguments[1]:void 0,i=r?arguments[2]:arguments[1];return this.on(e,o,t),this},n.prototype.releaseGroup=function(e){var t,n,r,o;for(t in this.callbacks)for(o=this.callbacks[t],n=0,r=o.length;r>n;n++)o[n]._groupName===e&&(o.splice(n,1),n--,r--);return this},n.prototype.off=function(e,t){var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e],this):this},n.prototype.emit=function(e){var t,n,r,o=[].slice.call(arguments,1),i=this.callbacks[e],a=this.getWildcardCallbacks(e);if(i)for(r=i.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,o);if(a)for(n=a.length,r=a.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,[e].concat(o));return this},n.prototype.getWildcardCallbacks=function(e){var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},{}],19:[function(e,t,n){var r=e("./lib/tosdp"),o=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return o.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return o.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return o.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return o.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return o.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return o.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return o.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return o.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=o.toCandidateJSON,n.toMediaJSON=o.toMediaJSON,n.toSessionJSON=o.toSessionJSON},{"./lib/tojson":24,"./lib/tosdp":23}],16:[function(e,t){var n=e("getusermedia"),r={};t.exports=function(e,t){var o,i=2===arguments.length,a=i?t:e;if("undefined"==typeof window||"http:"===window.location.protocol)return o=new Error("NavigatorUserMediaError"),o.name="HTTPS_REQUIRED",a(o);if(window.navigator.userAgent.match("Chrome")){var s=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),c=33,u=!window.chrome.webstore;if(window.navigator.userAgent.match("Linux")&&(c=35),sessionStorage.getScreenMediaJSExtensionId)chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(t){if(""===t.sourceId){var r=new Error("NavigatorUserMediaError");r.name="PERMISSION_DENIED",a(r)}else e=i&&e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=t.sourceId,n(e,a)});else if(window.cefGetScreenMedia)window.cefGetScreenMedia(function(t){if(t)e=i&&e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=t,n(e,a);else{var r=new Error("cefGetScreenMediaError");r.name="CEF_GETSCREENMEDIA_CANCELED",a(r)}});else if(u||s>=26&&c>=s)e=i&&e||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},n(e,a);else{var d=window.setTimeout(function(){return o=new Error("NavigatorUserMediaError"),o.name="EXTENSION_UNAVAILABLE",a(o)},1e3);r[d]=[a,i?constraint:null],window.postMessage({type:"getScreen",id:d},"*")}}else if(window.navigator.userAgent.match("Firefox")){var l=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10);l>=33?(e=i&&e||{video:{mozMediaSource:"window",mediaSource:"window"}},n(e,function(e,t){if(a(e,t),!e)var n=t.currentTime,r=window.setInterval(function(){t||window.clearInterval(r),t.currentTime==n&&(window.clearInterval(r),t.onended&&t.onended()),n=t.currentTime},500)})):(o=new Error("NavigatorUserMediaError"),o.name="EXTENSION_UNAVAILABLE")}},window.addEventListener("message",function(e){if(e.origin==window.location.origin)if("gotScreen"==e.data.type&&r[e.data.id]){var t=r[e.data.id],o=t[1],i=t[0];if(delete r[e.data.id],""===e.data.sourceId){var a=new Error("NavigatorUserMediaError");a.name="PERMISSION_DENIED",i(a)}else o=o||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},o.video.mandatory.chromeMediaSourceId=e.data.sourceId,n(o,i)}else"getScreenPending"==e.data.type&&window.clearTimeout(e.data.id)})},{getusermedia:14}],17:[function(e,t){function n(e){if(this.support=r.webAudio&&r.mediaStream,this.gain=1,this.support){var t=this.context=new r.AudioContext;this.microphone=t.createMediaStreamSource(e),this.gainFilter=t.createGain(),this.destination=t.createMediaStreamDestination(),this.outputStream=this.destination.stream,this.microphone.connect(this.gainFilter),this.gainFilter.connect(this.destination),e.addTrack(this.outputStream.getAudioTracks()[0]),e.removeTrack(e.getAudioTracks()[0])}this.stream=e}var r=e("webrtcsupport");n.prototype.setGain=function(e){this.support&&(this.gainFilter.gain.value=e,this.gain=e)},n.prototype.getGain=function(){return this.gain},n.prototype.off=function(){return this.setGain(0)},n.prototype.on=function(){this.setGain(1)},t.exports=n},{webrtcsupport:4}],21:[function(e,t){function n(e,t){return function(n,r,o){return"function"==typeof r&&void 0===o&&a(n)?e(n,r):t(n,i(r,o,3))}}var r=e("lodash._arrayeach"),o=e("lodash._baseeach"),i=e("lodash._bindcallback"),a=e("lodash.isarray"),s=n(r,o);t.exports=s},{"lodash._arrayeach":28,"lodash._baseeach":27,"lodash._bindcallback":25,"lodash.isarray":26}],22:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function r(e){var t=e+"";return e=d(e),function(n){return u(n,e,t)}}function o(e,t){var n=typeof e;if("string"==n&&h.test(e)||"number"==n)return!0;if(l(e))return!1;var r=!f.test(e);return r||null!=t&&e in i(t)}function i(e){return s(e)?e:Object(e)}function a(e,t){return p(e,c(t))}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return o(e)?n(e):r(e)}var u=e("lodash._baseget"),d=e("lodash._topath"),l=e("lodash.isarray"),p=e("lodash.map"),f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,h=/^\w*$/;t.exports=a},{"lodash._baseget":29,"lodash._topath":30,"lodash.isarray":31,"lodash.map":32}],23:[function(e,t,n){var r=e("./senders");n.toSessionSDP=function(e,t){t.role||"initiator",t.direction||"outgoing";var r=t.sid||e.sid||Date.now(),o=t.time||Date.now(),i=["v=0","o=- "+r+" "+o+" IN IP4 0.0.0.0","s=-","t=0 0"],a=e.groups||[];a.forEach(function(e){i.push("a=group:"+e.semantics+" "+e.contents.join(" "))});var s=e.contents||[];return s.forEach(function(e){i.push(n.toMediaSDP(e,t))}),i.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var o=[],i=t.role||"initiator",a=t.direction||"outgoing",s=e.description,c=e.transport,u=s.payloads||[],d=c&&c.fingerprints||[],l=[];if("datachannel"==s.descType?(l.push("application"),l.push("1"),l.push("DTLS/SCTP"),c.sctp&&c.sctp.forEach(function(e){l.push(e.number)})):(l.push(s.media),l.push("1"),s.encryption&&s.encryption.length>0||d.length>0?l.push("RTP/SAVPF"):l.push("RTP/AVPF"),u.forEach(function(e){l.push(e.id)})),o.push("m="+l.join(" ")),o.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&o.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.descType&&o.push("a=rtcp:1 IN IP4 0.0.0.0"),c){c.ufrag&&o.push("a=ice-ufrag:"+c.ufrag),c.pwd&&o.push("a=ice-pwd:"+c.pwd);var p=!1;d.forEach(function(e){o.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&!p&&o.push("a=setup:"+e.setup)}),c.sctp&&c.sctp.forEach(function(e){o.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)})}"rtp"==s.descType&&o.push("a="+(r[i][a][e.senders]||"sendrecv")),o.push("a=mid:"+e.name),s.sources&&s.sources.length&&(s.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&o.push("a=msid:"+e.value)}),s.mux&&o.push("a=rtcp-mux");var f=s.encryption||[];f.forEach(function(e){o.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.googConferenceFlag&&o.push("a=x-google-flag:conference"),u.forEach(function(e){var t="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(t+="/"+e.channels),o.push(t),e.parameters&&e.parameters.length){var n=["a=fmtp:"+e.id],r=[];e.parameters.forEach(function(e){r.push((e.key?e.key+"=":"")+e.value)}),n.push(r.join(";")),o.push(n.join(" "))}e.feedback&&e.feedback.forEach(function(t){"trr-int"===t.type?o.push("a=rtcp-fb:"+e.id+" trr-int "+(t.value?t.value:"0")):o.push("a=rtcp-fb:"+e.id+" "+t.type+(t.subtype?" "+t.subtype:""))})}),s.feedback&&s.feedback.forEach(function(e){"trr-int"===e.type?o.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):o.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))});var h=s.headerExtensions||[];h.forEach(function(e){o.push("a=extmap:"+e.id+(e.senders?"/"+r[i][a][e.senders]:"")+" "+e.uri)});var g=s.sourceGroups||[];g.forEach(function(e){o.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))});var m=s.sources||[];m.forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];o.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+n.key+(n.value?":"+n.value:""))}});var v=c.candidates||[];return v.forEach(function(e){o.push(n.toCandidateSDP(e))}),o.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),("srflx"===n||"prflx"===n||"relay"===n)&&e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":33}],24:[function(e,t,n){var r=e("./senders"),o=e("./parsers"),i=Math.random();n._setIdCounter=function(e){i=e},n.toSessionJSON=function(e,t){var r,i=t.creators||[],a=t.role||"initiator",s=t.direction||"outgoing",c=e.split("\r\nm=");for(r=1;r<c.length;r++)c[r]="m="+c[r],r!==c.length-1&&(c[r]+="\r\n");var u=c.shift()+"\r\n",d=o.lines(u),l={},p=[];for(r=0;r<c.length;r++)p.push(n.toMediaJSON(c[r],u,{role:a,direction:s,creator:i[r]||"initiator"}));l.contents=p;var f=o.findLines("a=group:",d);return f.length&&(l.groups=o.groups(f)),l},n.toMediaJSON=function(e,t,i){var a=i.creator||"initiator",s=i.role||"initiator",c=i.direction||"outgoing",u=o.lines(e),d=o.lines(t),l=o.mline(u[0]),p={creator:a,name:l.media,description:{descType:"rtp",media:l.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transType:"iceUdp",candidates:[],fingerprints:[]}};"application"==l.media&&(p.description={descType:"datachannel"},p.transport.sctp=[]);var f=p.description,h=p.transport,g=o.findLine("a=mid:",u);if(g&&(p.name=g.substr(6)),o.findLine("a=sendrecv",u,d)?p.senders="both":o.findLine("a=sendonly",u,d)?p.senders=r[s][c].sendonly:o.findLine("a=recvonly",u,d)?p.senders=r[s][c].recvonly:o.findLine("a=inactive",u,d)&&(p.senders="none"),"rtp"==f.descType){var m=o.findLine("b=",u);m&&(f.bandwidth=o.bandwidth(m));var v=o.findLine("a=ssrc:",u);v&&(f.ssrc=v.substr(7).split(" ")[0]);var y=o.findLines("a=rtpmap:",u);y.forEach(function(e){var t=o.rtpmap(e);t.parameters=[],t.feedback=[];var n=o.findLines("a=fmtp:"+t.id,u);n.forEach(function(e){t.parameters=o.fmtp(e)});var r=o.findLines("a=rtcp-fb:"+t.id,u);r.forEach(function(e){t.feedback.push(o.rtcpfb(e))}),f.payloads.push(t)});var b=o.findLines("a=crypto:",u,d);b.forEach(function(e){f.encryption.push(o.crypto(e))}),o.findLine("a=rtcp-mux",u)&&(f.mux=!0);var S=o.findLines("a=rtcp-fb:*",u);S.forEach(function(e){f.feedback.push(o.rtcpfb(e))});var w=o.findLines("a=extmap:",u);w.forEach(function(e){var t=o.extmap(e);t.senders=r[s][c][t.senders],f.headerExtensions.push(t)});var C=o.findLines("a=ssrc-group:",u);f.sourceGroups=o.sourceGroups(C||[]);var k=o.findLines("a=ssrc:",u),E=f.sources=o.sources(k||[]),O=o.findLine("a=msid:",u);if(O){var j=o.msid(O);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<E.length;t++){for(var n=!1,r=0;r<E[t].parameters.length;r++)E[t].parameters[r].key===e&&(n=!0);n||E[t].parameters.push({key:e,value:j[e]})}})}o.findLine("a=x-google-flag:conference",u,d)&&(f.googConferenceFlag=!0)}var _=o.findLines("a=fingerprint:",u,d),x=o.findLine("a=setup:",u,d);_.forEach(function(e){var t=o.fingerprint(e);x&&(t.setup=x.substr(8)),h.fingerprints.push(t)});var D=o.findLine("a=ice-ufrag:",u,d),M=o.findLine("a=ice-pwd:",u,d);if(D&&M){h.ufrag=D.substr(12),h.pwd=M.substr(10),h.candidates=[];var A=o.findLines("a=candidate:",u,d);A.forEach(function(e){h.candidates.push(n.toCandidateJSON(e))})}if("datachannel"==f.descType){var R=o.findLines("a=sctpmap:",u);R.forEach(function(e){var t=o.sctpmap(e);h.sctp.push(t)})}return p},n.toCandidateJSON=function(e){var t=o.candidate(e.split("\r\n")[0]);return t.id=(i++).toString(36).substr(0,12),t}},{"./parsers":34,"./senders":33}],26:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return a(n)?n:void 0}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&b>=e}function a(e){return null==e?!1:m.call(e)==u?v.test(h.call(e)):r(e)&&p.test(e)}function s(e){return e=n(e),e&&l.test(e)?e.replace(d,"\\$&"):e}var c="[object Array]",u="[object Function]",d=/[.*+?^${}()|[\]\/\\]/g,l=RegExp(d.source),p=/^\[object .+?Constructor\]$/,f=Object.prototype,h=Function.prototype.toString,g=f.hasOwnProperty,m=f.toString,v=RegExp("^"+s(h.call(g)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),y=o(Array,"isArray"),b=9007199254740991,S=y||function(e){return r(e)&&i(e.length)&&m.call(e)==c};t.exports=S},{}],29:[function(e,t){function n(e,t,n){if(null!=e){void 0!==n&&n in r(e)&&(t=[n]);for(var o=0,i=t.length;null!=e&&i>o;)e=e[t[o++]];return o&&o==i?e:void 0}}function r(e){return o(e)?e:Object(e)}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=n},{}],28:[function(e,t){function n(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}t.exports=n},{}],25:[function(e,t){function n(e,t,n){if("function"!=typeof e)return r;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)
};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)};case 5:return function(n,r,o,i,a){return e.call(t,n,r,o,i,a)}}return function(){return e.apply(t,arguments)}}function r(e){return e}t.exports=n},{}],31:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return a(n)?n:void 0}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&b>=e}function a(e){return null==e?!1:m.call(e)==u?v.test(h.call(e)):r(e)&&p.test(e)}function s(e){return e=n(e),e&&l.test(e)?e.replace(d,"\\$&"):e}var c="[object Array]",u="[object Function]",d=/[.*+?^${}()|[\]\/\\]/g,l=RegExp(d.source),p=/^\[object .+?Constructor\]$/,f=Object.prototype,h=Function.prototype.toString,g=f.hasOwnProperty,m=f.toString,v=RegExp("^"+s(h.call(g)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),y=o(Array,"isArray"),b=9007199254740991,S=y||function(e){return r(e)&&i(e.length)&&m.call(e)==c};t.exports=S},{}],33:[function(e,t){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],34:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var r=e.length,o=0;o<t.length;o++)if(t[o].substr(0,r)===e)return t[o];if(!n)return!1;for(var i=0;i<n.length;i++)if(n[i].substr(0,r)===e)return n[i];return!1},n.findLines=function(e,t,n){for(var r=[],o=e.length,i=0;i<t.length;i++)t[i].substr(0,o)===e&&r.push(t[i]);if(r.length||!n)return r;for(var a=0;a<n.length;a++)n[a].substr(0,o)===e&&r.push(n[a]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" "),n={number:t.shift(),protocol:t.shift(),streams:t.shift()};return n},n.fmtp=function(e){for(var t,n,r,o=e.substr(e.indexOf(" ")+1).split(";"),i=[],a=0;a<o.length;a++)t=o[a].split("="),n=t[0].trim(),r=t[1],n&&r?i.push({key:n,value:r}):n&&i.push({key:"",value:n});return i},n.crypto=function(e){var t=e.substr(9).split(" "),n={tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")};return n},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),o=r.indexOf("/");return o>=0?(n.id=r.substr(0,o),n.senders=r.substr(o+1)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r].substr(7).split(" "),i=o.shift();if(!n[i]){var a={ssrc:i,parameters:[]};t.push(a),n[i]=a}o=o.join(" ").split(":");var s=o.shift(),c=o.join(":")||null;n[i].parameters.push({key:s,value:c})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],20:[function(e,t){function n(e){return{type:e.type,sdp:e.sdp}}function r(e){var t={label:e.id};return e.getAudioTracks().length&&(t.audio=e.getAudioTracks().map(function(e){return e.id})),e.getVideoTracks().length&&(t.video=e.getVideoTracks().map(function(e){return e.id})),t}function o(e,t){var n=this;s.call(this),this.peerconnection=new a.PeerConnection(e,t),this.trace=function(e,t){n.emit("PeerConnectionTrace",{time:new Date,type:e,value:t||""})},this.onicecandidate=null,this.peerconnection.onicecandidate=function(e){n.trace("onicecandidate",e.candidate),null!==n.onicecandidate&&n.onicecandidate(e)},this.onaddstream=null,this.peerconnection.onaddstream=function(e){n.trace("onaddstream",r(e.stream)),null!==n.onaddstream&&n.onaddstream(e)},this.onremovestream=null,this.peerconnection.onremovestream=function(e){n.trace("onremovestream",r(e.stream)),null!==n.onremovestream&&n.onremovestream(e)},this.onsignalingstatechange=null,this.peerconnection.onsignalingstatechange=function(e){n.trace("onsignalingstatechange",n.signalingState),null!==n.onsignalingstatechange&&n.onsignalingstatechange(e)},this.oniceconnectionstatechange=null,this.peerconnection.oniceconnectionstatechange=function(e){n.trace("oniceconnectionstatechange",n.iceConnectionState),null!==n.oniceconnectionstatechange&&n.oniceconnectionstatechange(e)},this.onnegotiationneeded=null,this.peerconnection.onnegotiationneeded=function(e){n.trace("onnegotiationneeded"),null!==n.onnegotiationneeded&&n.onnegotiationneeded(e)},n.ondatachannel=null,this.peerconnection.ondatachannel=function(e){n.trace("ondatachannel",e),null!==n.ondatachannel&&n.ondatachannel(e)},this.getLocalStreams=this.peerconnection.getLocalStreams.bind(this.peerconnection),this.getRemoteStreams=this.peerconnection.getRemoteStreams.bind(this.peerconnection)}var i=e("util"),a=e("webrtcsupport"),s=e("wildemitter");i.inherits(o,s),Object.defineProperty(o.prototype,"signalingState",{get:function(){return this.peerconnection.signalingState}}),Object.defineProperty(o.prototype,"iceConnectionState",{get:function(){return this.peerconnection.iceConnectionState}}),Object.defineProperty(o.prototype,"localDescription",{get:function(){return this.peerconnection.localDescription}}),Object.defineProperty(o.prototype,"remoteDescription",{get:function(){return this.peerconnection.remoteDescription}}),o.prototype.addStream=function(e){this.trace("addStream",r(e)),this.peerconnection.addStream(e)},o.prototype.removeStream=function(e){this.trace("removeStream",r(e)),this.peerconnection.removeStream(e)},o.prototype.createDataChannel=function(e,t){return this.trace("createDataChannel",e,t),this.peerconnection.createDataChannel(e,t)},o.prototype.setLocalDescription=function(e,t,r){var o=this;this.trace("setLocalDescription",n(e)),this.peerconnection.setLocalDescription(e,function(){o.trace("setLocalDescriptionOnSuccess"),t()},function(e){o.trace("setLocalDescriptionOnFailure",e),r(e)})},o.prototype.setRemoteDescription=function(e,t,r){var o=this;this.trace("setRemoteDescription",n(e)),this.peerconnection.setRemoteDescription(e,function(){o.trace("setRemoteDescriptionOnSuccess"),t()},function(e){o.trace("setRemoteDescriptionOnFailure",e),r(e)})},o.prototype.close=function(){this.trace("stop"),null!==this.statsinterval&&(window.clearInterval(this.statsinterval),this.statsinterval=null),"closed"!=this.peerconnection.signalingState&&this.peerconnection.close()},o.prototype.createOffer=function(e,t,r){var o=this;this.trace("createOffer",r),this.peerconnection.createOffer(function(t){o.trace("createOfferOnSuccess",n(t)),e(t)},function(e){o.trace("createOfferOnFailure",e),t(e)},r)},o.prototype.createAnswer=function(e,t,r){var o=this;this.trace("createAnswer",r),this.peerconnection.createAnswer(function(t){o.trace("createAnswerOnSuccess",n(t)),e(t)},function(e){o.trace("createAnswerOnFailure",e),t(e)},r)},o.prototype.addIceCandidate=function(e,t,n){var r=this;this.trace("addIceCandidate",e),this.peerconnection.addIceCandidate(e,function(){t&&t()},function(e){r.trace("addIceCandidateOnFailure",e),n&&n(e)})},o.prototype.getStats=function(e,t){navigator.mozGetUserMedia?this.peerconnection.getStats(null,e,t):this.peerconnection.getStats(e)},t.exports=o},{util:7,webrtcsupport:4,wildemitter:3}],27:[function(e,t){function n(e,t){return p(e,t,u)}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e,t){return function(n,r){var o=n?f(n):0;if(!a(o))return e(n,r);for(var i=t?o:-1,c=s(n);(t?i--:++i<o)&&r(c[i],i,c)!==!1;);return n}}function i(e){return function(t,n,r){for(var o=s(t),i=r(t),a=i.length,c=e?a:-1;e?c--:++c<a;){var u=i[c];if(n(o[u],u,o)===!1)break}return t}}function a(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function s(e){return c(e)?e:Object(e)}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=e("lodash.keys"),d=9007199254740991,l=o(n),p=i(),f=r("length");t.exports=l},{"lodash.keys":35}],36:[function(e,t){function n(e,t){for(var n=-1,r=e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}t.exports=n},{}],30:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e){if(o(e))return e;var t=[];return n(e).replace(i,function(e,n,r,o){t.push(r?o.replace(a,"$1"):n||e)}),t}var o=e("lodash.isarray"),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g;t.exports=r},{"lodash.isarray":31}],32:[function(e,t){function n(e,t){var n=-1,r=o(e)?Array(e.length):[];return u(e,function(e,o,i){r[++n]=t(e,o,i)}),r}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&i(p(e))}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&l>=e}function a(e,t,r){var o=d(e)?s:n;return t=c(t,r,3),o(e,t)}var s=e("lodash._arraymap"),c=e("lodash._basecallback"),u=e("lodash._baseeach"),d=e("lodash.isarray"),l=9007199254740991,p=r("length");t.exports=a},{"lodash._arraymap":36,"lodash._basecallback":37,"lodash._baseeach":38,"lodash.isarray":31}],39:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return i(n)?n:void 0}function i(e){return null==e?!1:h.call(e)==s?g.test(p.call(e)):r(e)&&d.test(e)}function a(e){return e=n(e),e&&u.test(e)?e.replace(c,"\\$&"):e}var s="[object Function]",c=/[.*+?^${}()|[\]\/\\]/g,u=RegExp(c.source),d=/^\[object .+?Constructor\]$/,l=Object.prototype,p=Function.prototype.toString,f=l.hasOwnProperty,h=l.toString,g=RegExp("^"+a(p.call(f)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=o},{}],40:[function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&i(l(e))}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function a(e){return n(e)&&o(e)&&u.call(e)==s}var s="[object Arguments]",c=Object.prototype,u=c.toString,d=9007199254740991,l=r("length");t.exports=a},{}],41:[function(e,t){function n(e,t,n){if("function"!=typeof e)return r;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)};case 5:return function(n,r,o,i,a){return e.call(t,n,r,o,i,a)}}return function(){return e.apply(t,arguments)}}function r(e){return e}t.exports=n},{}],38:[function(e,t){function n(e,t){return p(e,t,u)}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e,t){return function(n,r){var o=n?f(n):0;if(!a(o))return e(n,r);for(var i=t?o:-1,c=s(n);(t?i--:++i<o)&&r(c[i],i,c)!==!1;);return n}}function i(e){return function(t,n,r){for(var o=s(t),i=r(t),a=i.length,c=e?a:-1;e?c--:++c<a;){var u=i[c];if(n(o[u],u,o)===!1)break}return t}}function a(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function s(e){return c(e)?e:Object(e)}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=e("lodash.keys"),d=9007199254740991,l=o(n),p=i(),f=r("length");t.exports=l},{"lodash.keys":42}],35:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&i(v(e))}function o(e,t){return e="number"==typeof e||p.test(e)?+e:-1,t=null==t?m:t,e>-1&&0==e%1&&t>e}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&m>=e}function a(e){for(var t=c(e),n=t.length,r=n&&e.length,a=!!r&&i(r)&&(l(e)||d(e)),s=-1,u=[];++s<n;){var p=t[s];(a&&o(p,r)||h.call(e,p))&&u.push(p)}return u}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){if(null==e)return[];s(e)||(e=Object(e));var t=e.length;t=t&&i(t)&&(l(e)||d(e))&&t||0;for(var n=e.constructor,r=-1,a="function"==typeof n&&n.prototype===e,c=Array(t),u=t>0;++r<t;)c[r]=r+"";for(var p in e)u&&o(p,t)||"constructor"==p&&(a||!h.call(e,p))||c.push(p);return c}var u=e("lodash._getnative"),d=e("lodash.isarguments"),l=e("lodash.isarray"),p=/^\d+$/,f=Object.prototype,h=f.hasOwnProperty,g=u(Object,"keys"),m=9007199254740991,v=n("length"),y=g?function(e){var t=null==e?null:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&r(e)?a(e):s(e)?g(e):[]}:a;t.exports=y},{"lodash._getnative":39,"lodash.isarguments":40,"lodash.isarray":26}],37:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e,t,n){var r=typeof e;return"function"==r?void 0===t?e:w(e,t,n):null==e?y:"object"==r?a(e):void 0===t?b(e):s(e,t)}function o(e,t,n){if(null!=e){void 0!==n&&n in h(e)&&(t=[n]);for(var r=0,o=t.length;null!=e&&o>r;)e=e[t[r++]];return r&&r==o?e:void 0}}function i(e,t,n){var r=t.length,o=r,i=!n;if(null==e)return!o;for(e=h(e);r--;){var a=t[r];if(i&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<o;){a=t[r];var s=a[0],c=e[s],u=a[1];if(i&&a[2]){if(void 0===c&&!(s in e))return!1}else{var d=n?n(c,u,s):void 0;if(!(void 0===d?S(u,c,n,!0):d))return!1}}return!0}function a(e){var t=l(e);if(1==t.length&&t[0][2]){var n=t[0][0],r=t[0][1];return function(e){return null==e?!1:e[n]===r&&(void 0!==r||n in h(e))}}return function(e){return i(e,t)}}function s(e,t){var n=C(e),r=p(e)&&f(t),i=e+"";return e=g(e),function(a){if(null==a)return!1;var s=i;if(a=h(a),!(!n&&r||s in a)){if(a=1==e.length?a:o(a,d(e,0,-1)),null==a)return!1;s=m(e),a=h(a)}return a[s]===t?void 0!==t||s in a:S(t,a[s],void 0,!0)}}function c(e){return function(t){return null==t?void 0:t[e]}}function u(e){var t=e+"";return e=g(e),function(n){return o(n,e,t)}}function d(e,t,n){var r=-1,o=e.length;t=null==t?0:+t||0,0>t&&(t=-t>o?0:o+t),n=void 0===n||n>o?o:+n||0,0>n&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}function l(e){for(var t=k(e),n=t.length;n--;)t[n][2]=f(t[n][1]);return t}function p(e,t){var n=typeof e;if("string"==n&&O.test(e)||"number"==n)return!0;if(C(e))return!1;var r=!E.test(e);return r||null!=t&&e in h(t)}function f(e){return e===e&&!v(e)}function h(e){return v(e)?e:Object(e)}function g(e){if(C(e))return e;var t=[];return n(e).replace(j,function(e,n,r,o){t.push(r?o.replace(_,"$1"):n||e)}),t}function m(e){var t=e?e.length:0;return t?e[t-1]:void 0}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){return e}function b(e){return p(e)?c(e):u(e)}var S=e("lodash._baseisequal"),w=e("lodash._bindcallback"),C=e("lodash.isarray"),k=e("lodash.pairs"),E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,O=/^\w*$/,j=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,_=/\\(\\)?/g;t.exports=r},{"lodash._baseisequal":43,"lodash._bindcallback":41,"lodash.isarray":31,"lodash.pairs":44}],45:[function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e){return"number"==typeof e&&e>-1&&0==e%1&&A>=e}function o(e){return n(e)&&r(e.length)&&!!x[M.call(e)]}var i="[object Arguments]",a="[object Array]",s="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",l="[object Map]",p="[object Number]",f="[object Object]",h="[object RegExp]",g="[object Set]",m="[object String]",v="[object WeakMap]",y="[object ArrayBuffer]",b="[object Float32Array]",S="[object Float64Array]",w="[object Int8Array]",C="[object Int16Array]",k="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",j="[object Uint16Array]",_="[object Uint32Array]",x={};x[b]=x[S]=x[w]=x[C]=x[k]=x[E]=x[O]=x[j]=x[_]=!0,x[i]=x[a]=x[y]=x[s]=x[c]=x[u]=x[d]=x[l]=x[p]=x[f]=x[h]=x[g]=x[m]=x[v]=!1;var D=Object.prototype,M=D.toString,A=9007199254740991;t.exports=o},{}],46:[function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e){return function(t){return null==t?void 0:t[e]}}function o(e){return null!=e&&i(l(e))}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function a(e){return n(e)&&o(e)&&u.call(e)==s}var s="[object Arguments]",c=Object.prototype,u=c.toString,d=9007199254740991,l=r("length");t.exports=a},{}],47:[function(e,t){function n(e){return"string"==typeof e?e:null==e?"":e+""}function r(e){return!!e&&"object"==typeof e}function o(e,t){var n=null==e?void 0:e[t];return i(n)?n:void 0}function i(e){return null==e?!1:h.call(e)==s?g.test(p.call(e)):r(e)&&d.test(e)}function a(e){return e=n(e),e&&u.test(e)?e.replace(c,"\\$&"):e}var s="[object Function]",c=/[.*+?^${}()|[\]\/\\]/g,u=RegExp(c.source),d=/^\[object .+?Constructor\]$/,l=Object.prototype,p=Function.prototype.toString,f=l.hasOwnProperty,h=l.toString,g=RegExp("^"+a(p.call(f)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=o},{}],44:[function(e,t){function n(e){return r(e)?e:Object(e)}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){e=n(e);for(var t=-1,r=i(e),o=r.length,a=Array(o);++t<o;){var s=r[t];a[t]=[s,e[s]]}return a}var i=e("lodash.keys");t.exports=o},{"lodash.keys":42}],43:[function(e,t){function n(e){return!!e&&"object"==typeof e}function r(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function o(e,t,r,a,s,c){return e===t?!0:null==e||null==t||!u(e)&&!n(t)?e!==e&&t!==t:i(e,t,o,r,a,s,c)}function i(e,t,n,r,o,i,u){var p=d(e),g=d(t),m=h,v=h;p||(m=E.call(e),m==f?m=b:m!=b&&(p=l(e))),g||(v=E.call(t),v==f?v=b:v!=b&&(g=l(t)));var y=m==b,S=v==b,w=m==v;if(w&&!p&&!y)return s(e,t,m);if(!o){var C=y&&k.call(e,"__wrapped__"),O=S&&k.call(t,"__wrapped__");if(C||O)return n(C?e.value():e,O?t.value():t,r,o,i,u)}if(!w)return!1;i||(i=[]),u||(u=[]);for(var j=i.length;j--;)if(i[j]==e)return u[j]==t;i.push(e),u.push(t);var _=(p?a:c)(e,t,n,r,o,i,u);return i.pop(),u.pop(),_}function a(e,t,n,o,i,a,s){var c=-1,u=e.length,d=t.length;if(u!=d&&!(i&&d>u))return!1;for(;++c<u;){var l=e[c],p=t[c],f=o?o(i?p:l,i?l:p,c):void 0;if(void 0!==f){if(f)continue;return!1}if(i){if(!r(t,function(e){return l===e||n(l,e,o,i,a,s)}))return!1}else if(l!==p&&!n(l,p,o,i,a,s))return!1}return!0}function s(e,t,n){switch(n){case g:case m:return+e==+t;case v:return e.name==t.name&&e.message==t.message;case y:return e!=+e?t!=+t:e==+t;case S:case w:return e==t+""}return!1}function c(e,t,n,r,o,i,a){var s=p(e),c=s.length,u=p(t),d=u.length;if(c!=d&&!o)return!1;for(var l=c;l--;){var f=s[l];if(!(o?f in t:k.call(t,f)))return!1}for(var h=o;++l<c;){f=s[l];var g=e[f],m=t[f],v=r?r(o?m:g,o?g:m,f):void 0;if(!(void 0===v?n(g,m,r,o,i,a):v))return!1;h||(h="constructor"==f)}if(!h){var y=e.constructor,b=t.constructor;if(y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b))return!1}return!0}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var d=e("lodash.isarray"),l=e("lodash.istypedarray"),p=e("lodash.keys"),f="[object Arguments]",h="[object Array]",g="[object Boolean]",m="[object Date]",v="[object Error]",y="[object Number]",b="[object Object]",S="[object RegExp]",w="[object String]",C=Object.prototype,k=C.hasOwnProperty,E=C.toString;t.exports=o},{"lodash.isarray":31,"lodash.istypedarray":45,"lodash.keys":42}],42:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&i(v(e))}function o(e,t){return e="number"==typeof e||p.test(e)?+e:-1,t=null==t?m:t,e>-1&&0==e%1&&t>e}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&m>=e}function a(e){for(var t=c(e),n=t.length,r=n&&e.length,a=!!r&&i(r)&&(l(e)||d(e)),s=-1,u=[];++s<n;){var p=t[s];(a&&o(p,r)||h.call(e,p))&&u.push(p)}return u}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){if(null==e)return[];s(e)||(e=Object(e));var t=e.length;t=t&&i(t)&&(l(e)||d(e))&&t||0;for(var n=e.constructor,r=-1,a="function"==typeof n&&n.prototype===e,c=Array(t),u=t>0;++r<t;)c[r]=r+"";for(var p in e)u&&o(p,t)||"constructor"==p&&(a||!h.call(e,p))||c.push(p);return c}var u=e("lodash._getnative"),d=e("lodash.isarguments"),l=e("lodash.isarray"),p=/^\d+$/,f=Object.prototype,h=f.hasOwnProperty,g=u(Object,"keys"),m=9007199254740991,v=n("length"),y=g?function(e){var t=null==e?null:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&r(e)?a(e):s(e)?g(e):[]}:a;t.exports=y},{"lodash._getnative":47,"lodash.isarguments":46,"lodash.isarray":31}]},{},[1])(1)});